# services:
#   - type: web
#     name: chat-app
#     env: node
#     plan: free
#     buildCommand: "npm run build"
#     startCommand: "npm run start"
#     autoDeploy: true
#     envVars:
#       - key: PORT
#         value: 8080
#       - key: MONGO_URI
#         sync: false
#       - key: JWT_SECRET
#         sync: false
#       - key: FRONTEND_URL
#         value: https://chat-app.onrender.com



services:
  # ===============================
  # Backend Service
  # ===============================
  - type: web
    name: chat-app-backend
    env: node
    plan: free
    rootDir: backend
    buildCommand: "npm install"
    startCommand: "npm run start"
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8080
      - key: MONGO_URI
        sync: false     # You will set this in Render dashboard
      - key: JWT_SECRET
        sync: false     # You will set this in Render dashboard
      - key: FRONTEND_URL
        value: https://chat-app-frontend.onrender.com  # <-- frontend URL

  # ===============================
  # Frontend Service (React)
  # ===============================
  - type: web
    name: chat-app-frontend
    env: node
    plan: free
    rootDir: frontend
    buildCommand: "npm install && npm run build"
    startCommand: "npx serve -s build"
    staticPublishPath: build
    autoDeploy: true
    envVars:
      - key: REACT_APP_API_URL
        value: https://chat-app-backend.onrender.com   # <-- backend URL
